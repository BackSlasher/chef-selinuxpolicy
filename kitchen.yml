---
driver:
  name: vagrant

provisioner:
  name: chef_zero
  deprecations_as_errors: true
  chef_license: accept-no-persist
  enforce_idempotency: true
  multiple_converge: 2
  # reboot tweaks:
  max_retries: 3
  wait_for_retry: 90
  retry_on_exit_code: [35, 213]
  client_rb:
    client_fork: false

platforms:
  - name: centos-6
  - name: centos-7
  - name: centos-8
  - name: fedora-latest

verifier:
  name: inspec

suites:
  - name: install
    run_list:
      - recipe[test::install]
  - name: boolean
    run_list:
      - recipe[test::install]
      - recipe[test::boolean]
  - name: fcontext
    run_list:
      - recipe[test::install]
      - recipe[test::fcontext]
  - name: module
    run_list:
      - recipe[test::install]
      - recipe[test::module]
  - name: module-directory
    run_list:
      - recipe[test::install]
      - recipe[test::module_directory]
  - name: module-remove
    run_list:
      - recipe[test::install]
      - recipe[test::module_remove]
    provisioner:
      enforce_idempotency: false
      multiple_converge: 1
  - name: permissive
    run_list:
      - recipe[test::install]
      - recipe[test::permissive]
  - name: port
    run_list:
      - recipe[test::install]
      - recipe[test::port]
